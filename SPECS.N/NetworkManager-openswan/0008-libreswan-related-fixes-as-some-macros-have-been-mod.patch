From 571c3af579c5753b82aab522486b6af45b27d7d8 Mon Sep 17 00:00:00 2001
From: Avesh Agarwal <avagarwa@redhat.com>
Date: Tue, 10 Dec 2013 14:01:00 -0500
Subject: [PATCH 08/20] libreswan related fixes, as some macros have been
 modified after forking to libreswan from openswan.

---
 src/nm-openswan-service-helper.c | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)

diff --git a/src/nm-openswan-service-helper.c b/src/nm-openswan-service-helper.c
index 35cd9d9..07bc576 100644
--- a/src/nm-openswan-service-helper.c
+++ b/src/nm-openswan-service-helper.c
@@ -210,6 +210,7 @@ main (int argc, char *argv[])
 	//long int mtu = 1412;
 	char nmask[16]="255.255.255.255";
 
+
 #if !GLIB_CHECK_VERSION (2, 35, 0)
 	g_type_init ();
 #endif
@@ -217,7 +218,7 @@ main (int argc, char *argv[])
 	/* openswan gives us a "reason" code.  If we are given one,
 	 * don't proceed unless its "connect".
 	 */
-	tmp = getenv ("openswan_reason");
+	tmp = getenv ("libreswan_reason");
 	if (tmp && strcmp (tmp, "connect") != 0)
 		exit (0);
 
@@ -287,7 +288,7 @@ main (int argc, char *argv[])
 //#endif
 
 	/* DNS */
-	val = addr_list_to_gvalue (getenv ("PLUTO_CISCO_DNS_INFO"));
+	val = addr_list_to_gvalue (getenv ("PLUTO_PEER_DNS_INFO"));
 	if (val)
 		g_hash_table_insert (config, NM_VPN_PLUGIN_IP4_CONFIG_DNS, val);
 
@@ -299,7 +300,7 @@ main (int argc, char *argv[])
 #endif
 
 	/* Default domain */
-	val = str_to_gvalue (getenv ("PLUTO_CISCO_DOMAIN_INFO"), TRUE);
+	val = str_to_gvalue (getenv ("PLUTO_PEER_DOMAIN_INFO"), TRUE);
 	if (val)
 		g_hash_table_insert (config, NM_VPN_PLUGIN_IP4_CONFIG_DOMAIN, val);
 
-- 
1.8.3.1

