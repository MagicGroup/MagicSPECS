From 2581ac2914b666b427a90ea400e757ef41030bdd Mon Sep 17 00:00:00 2001
From: Avesh Agarwal <avagarwa@redhat.com>
Date: Tue, 10 Dec 2013 14:45:06 -0500
Subject: [PATCH 13/20] Fixed more libreswan related changes.

---
 src/nm-openswan-service-helper.c | 7 +++----
 src/nm-openswan-service.c        | 8 ++++----
 2 files changed, 7 insertions(+), 8 deletions(-)

diff --git a/src/nm-openswan-service-helper.c b/src/nm-openswan-service-helper.c
index d521645..cde7443 100644
--- a/src/nm-openswan-service-helper.c
+++ b/src/nm-openswan-service-helper.c
@@ -204,8 +204,8 @@ addr_list_to_gvalue (const char *str)
  *
  * PLUTO_PEER             	-- vpn gateway address
  * PLUTO_MY_SOURCEIP		-- address
- * PLUTO_CISCO_DNS_INFO         -- list of dns serverss
- * PLUTO_CISCO_DOMAIN_INFO      -- default domain name
+ * PLUTO_PEER_DNS_INFO         -- list of dns serverss
+ * PLUTO_PEER_DOMAIN_INFO      -- default domain name
  * PLUTO_PEER_BANNER           -- banner from server
  *
  */
@@ -247,8 +247,7 @@ main (int argc, char *argv[])
 	if (val)
 		g_hash_table_insert (config, NM_VPN_PLUGIN_IP4_CONFIG_GATEWAY, val);
 	else
-		helper_failed (connection, "Openswan Pluto Right Peer (VPN Gateway)");
-
+		helper_failed (connection, "IPsec/Pluto Right Peer (VPN Gateway)");
 
 	/*
 	 * Tunnel device
diff --git a/src/nm-openswan-service.c b/src/nm-openswan-service.c
index 64792a6..d59c58f 100644
--- a/src/nm-openswan-service.c
+++ b/src/nm-openswan-service.c
@@ -860,15 +860,15 @@ main (int argc, char *argv[])
 	g_option_context_parse (opt_ctx, &argc, &argv, NULL);
 	g_option_context_free (opt_ctx);
 
-	if (getenv ("OPENSWAN_DEBUG"))
+	if (getenv ("IPSEC_DEBUG"))
 		debug = TRUE;
 
 	if (debug)
-		g_message ("nm-openswan-service (version " DIST_VERSION ") starting...");
+		g_printf ("nm-openswan-service (version " DIST_VERSION ") starting...\n");
 
 	plugin = nm_openswan_plugin_new ();
 	if (!plugin)
-		exit (1);
+		exit (EXIT_FAILURE);
 
 	loop = g_main_loop_new (NULL, FALSE);
 
@@ -881,5 +881,5 @@ main (int argc, char *argv[])
 	g_main_loop_unref (loop);
 	g_object_unref (plugin);
 
-	exit (0);
+	exit (EXIT_SUCCESS);
 }
-- 
1.8.3.1

