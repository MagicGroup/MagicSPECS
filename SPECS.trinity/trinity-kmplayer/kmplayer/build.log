





Name:		kmplayer
Version:		0.10.0c
Release:	1mgc30
Summary:	A multimedia mplayer/gstreamer/libxine frontend for KDE
Summary(zh_CN.UTF-8): KDE 下的 mplayer/gstreamer/libxine 的媒体播放器前端
License:		GPL
Group:		Applications/Multimedia
Group(zh_CN.UTF-8):	应用程序/多媒体
Url:		http://kmplayer.kde.org/
Source:		http://kmplayer.kde.org/pkgs/kmplayer-0.10.0c.tar.bz2
Patch1:		kmplayer-0.10.0c-admin.patch
BuildRoot:	/var/tmp/kmplayer-0.10.0c-1mgc30-buildroot-magic
BuildRequires: kdelibs-devel





BuildRequires: xine-lib-devel


Requires:	mplayer




%description
KMPlayer can play all the audio/video supported by mplayer/libxine/Gstreamer from local
file or url, be embedded inside Konqueror and KHTML and play DVD's.

%description -l zh_CN.UTF-8
KDE 下的 mplayer/gstreamer/libxine 的媒体播放器前端。

%prep
%setup -q -n kmplayer-0.10.0c
%patch1 -p1
chmod 777 admin/*

%build
unset QTDIR && . /etc/profile.d/qt.sh
# work around an improper ${kdelibsuff}
make -f admin/Makefile.common
export QTLIB=${QTDIR}/lib QTINC=${QTDIR}/include
./configure --prefix=/usr --disable-debug --enable-shared \
	--disable-static --disable-rpath \
	--disable-embedded --with-xinerama \
	--without-gstreamer \
	--enable-final
#临时措施
sed -i 's/\/include\/tqt/\/include\/tqt \-lX11/g' src/Makefile
make -j16


%package debuginfo 
Summary: Debug information for package kmplayer
Group: Development/Debug
AutoReqProv: 0
%description debuginfo
This package provides debug information for package kmplayer.
Debug information is useful when developing applications that use this
package or when debugging this package.
%files debuginfo -f debugfiles.list
%defattr(-,root,root)

%install

rm -rf /home/magic/rpmbuild/BUILDROOT/kmplayer-0.10.0c-1mgc30.x86_64
make DESTDIR=/home/magic/rpmbuild/BUILDROOT/kmplayer-0.10.0c-1mgc30.x86_64 install

# conflicts with file from package kdelibs
rm -f /home/magic/rpmbuild/BUILDROOT/kmplayer-0.10.0c-1mgc30.x86_64/usr/share/mimelnk/application/x-mplayer2.desktop
magic_rpm_clean.sh

%post
/sbin/ldconfig

%postun
/sbin/ldconfig

%clean
rm -rf /home/magic/rpmbuild/BUILDROOT/kmplayer-0.10.0c-1mgc30.x86_64 /home/magic/rpmbuild/BUILD/kmplayer-0.10.0c

%files
%defattr(-,root,root)
%doc AUTHORS ChangeLog README
/usr/bin/*
/usr/lib64/libk*
/usr/lib64/trinity/*
/usr/lib64/libtdeinit_kmplayer.*
/usr/share


%changelog
* Fri Aug 24 2007 kde <athena_star {at} 163 {dot} com> - 0.10.0-pre2-1mgc
- init the spec file
已加载插件：aliases, auto-update-debuginfo, changelog, fastestmirror, filter-data, fs-
          : snapshot, keys, list-data, local, merge-conf, post-transaction-
          : actions, priorities, protectbase, ps, puppetverify, refresh-
          : updatesd, remove-with-leaves, rpm-warm-cache, show-leaves, tmprepo,
          : tsflags, upgrade-helper, verify, versionlock
Loading mirror speeds from cached hostfile
错误：Cannot find a valid baseurl for repo: trinity-3.5.13/x86_64
Could not retrieve mirrorlist http://ppa.quickbuild.pearsoncomputing.net/trinity/trinity/rpm/f21/trinity-3.5.13-x86_64.list error was
14: HTTP Error 404 - Not Found : http://ftp.fau.de/trinity/trinity/rpm/f21/trinity-3.5.13-x86_64.list
错误：构建依赖失败：
	kdelibs-devel 被 kmplayer-0.10.0c-1mgc30.x86_64 需要
