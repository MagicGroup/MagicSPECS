autofs-5.1.0 - fix incorrect round robin host detection

From: Ian Kent <raven@themaw.net>


---
 CHANGELOG            |    1 +
 modules/replicated.c |    2 +-
 2 files changed, 2 insertions(+), 1 deletion(-)

diff --git a/CHANGELOG b/CHANGELOG
index ece8c5c..1b4e2fe 100644
--- a/CHANGELOG
+++ b/CHANGELOG
@@ -3,6 +3,7 @@
 - fix compile error in defaults.c.
 - add serialization to sasl init.
 - dont allocate dev_ctl_ops too early.
+- fix incorrect round robin host detection.
 
 04/06/2014 autofs-5.1.0
 =======================
diff --git a/modules/replicated.c b/modules/replicated.c
index 0c1a8a7..32860d5 100644
--- a/modules/replicated.c
+++ b/modules/replicated.c
@@ -946,7 +946,7 @@ try_name:
 	}
 
 	this = ni;
-	while (this->ai_next) {
+	while (this) {
 		if (this->ai_family == AF_INET) {
 			struct sockaddr_in *addr = (struct sockaddr_in *) this->ai_addr;
 			if (addr->sin_addr.s_addr != INADDR_LOOPBACK)
