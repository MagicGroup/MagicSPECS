From: Bill Meier <wmeier@newsguy.com>
Date: Tue, 17 Dec 2013 21:18:15 +0000
Subject: [PATCH] Copy over from Trunk

 ------------------------------------------------------------------------
 r54181 | wmeier | 2013-12-17 10:02:47 -0500 (Tue, 17 Dec 2013) | 8 lines

 From "bd": Fix " Wireshark stops showing new packets but dumpcap keeps writing them to the temp file"

 https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=9571

 From me: Fixed in a slightly different manner than sugested in the patch attached to the bug.
 ------------------------------------------------------------------------

svn path=/trunk-1.10/; revision=54196

diff --git a/dumpcap.c b/dumpcap.c
index 4d42e71..7098f0c 100644
--- a/dumpcap.c
+++ b/dumpcap.c
@@ -3653,8 +3653,8 @@ capture_loop_start(capture_options *capture_opts, gboolean *stats_known, struct
         if ((cur_time - upd_time) > DUMPCAP_UPD_TIME) { /* wrap just causes an extra update */
 #else
         gettimeofday(&cur_time, NULL);
-        if ((cur_time.tv_sec * 1000000 + cur_time.tv_usec) >
-            (upd_time.tv_sec * 1000000 + upd_time.tv_usec + DUMPCAP_UPD_TIME*1000)) {
+        if (((guint64)cur_time.tv_sec * 1000000 + cur_time.tv_usec) >
+            ((guint64)upd_time.tv_sec * 1000000 + upd_time.tv_usec + DUMPCAP_UPD_TIME*1000)) {
 #endif
 
             upd_time = cur_time;
