From 95cc21cf6283ef6faaa1be7c12c9ef58d7891d25 Mon Sep 17 00:00:00 2001
From: Chris Leech <cleech@redhat.com>
Date: Fri, 13 Sep 2013 16:56:51 -0700
Subject: [PATCH] fix hardened build of iscsiuio

The new iscsiuio code sets CFLAGS in configure.ac, wiping out the
environment setup by rpm.  Patch that out.

---
 iscsiuio/configure    | 2 +-
 iscsiuio/configure.ac | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/iscsiuio/configure b/iscsiuio/configure
index 444c9c0..50cfd90 100755
--- a/iscsiuio/configure
+++ b/iscsiuio/configure
@@ -22782,7 +22782,7 @@ LIBTOOL='$(SHELL) $(top_builddir)/libtool'
 
 
 
-CFLAGS="-O2 -Wall"
+CFLAGS="${CFLAGS} -O2 -Wall"
 ## check for --enable-debug first before checking CFLAGS before
 ## so that we don't mix -O and -g
 # Check whether --enable-debug was given.
diff --git a/iscsiuio/configure.ac b/iscsiuio/configure.ac
index 381b94d..e4af3b2 100644
--- a/iscsiuio/configure.ac
+++ b/iscsiuio/configure.ac
@@ -52,7 +52,7 @@ AC_LIBTOOL_DLOPEN
 # libtool stuff
 AC_PROG_LIBTOOL
 
-CFLAGS="-O2 -Wall"
+CFLAGS="${CFLAGS} -O2 -Wall"
 ## check for --enable-debug first before checking CFLAGS before
 ## so that we don't mix -O and -g
 AC_ARG_ENABLE(debug,
-- 
1.8.3.1

