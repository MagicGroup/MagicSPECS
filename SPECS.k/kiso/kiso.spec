# This spec file was generated by KDevelop
# Please report any problem to KDevelop Team <kdevelop-devel@kdevelop.org>
# Thanks to Matthias Saou for his explanations on http://freshrpms.net/docs/fight.html

Name: kiso
Version: 0.8.3
Release: 6%{?dist}
Vendor: http://kiso.sourceforge.net/
License: GPL
Summary: ISO-Images tool
Summary(zh_CN.UTF-8): ISO镜像工具
Group: Applications/System
Group(zh_CN.UTF-8): 应用程序/系统
Packager: KanKer
BuildRoot: %{_tmppath}/%{name}-root
Source0: %{name}-%{version}.tar.gz
Source1: Test.iso
Patch0: kiso-dirops.patch
Patch1: kiso.desktop-chinese.patch
Patch2: kiso-0.8.3-libcdio.patch
Patch3: kiso-0.8.3-sudo.patch
Patch4: kiso-0.8.3-admin.patch

%description
KIso is a GUI for KDE 3 which has the purpose to make creating, extracting and editing of ISO-Images as easy as possible.

%description -l zh_CN.UTF-8
KIso是KDE3下的一个图形界面，它可以简单的建立，解压和编辑ISO镜像。

%prep
%setup -q -n kiso-0.8.3
CFLAGS="$RPM_OPT_FLAGS" CXXFLAGS="$RPM_OPT_FLAGS" 

%patch0 -p1
%patch1 -p1
%patch2 -p1
%patch3 -p1
%patch4 -p1
chmod 777 admin/*

%build
make -f admin/Makefile.common
%configure
#临时措施
sed -i 's/\/include\/tqt/\/include\/tqt \-lqt\-mt \-ltdecore \-ltdeui \-lDCOP \-lkio/g' src/Makefile
make

%install

rm -rf %{buildroot}

%makeinstall
#rm -rf $RPM_BUILD_ROOT/usr/share/apps/konqueror/servicemenus/kiso_konqy.desktop
rm -rf $RPM_BUILD_ROOT/usr/share/mimelnk/application/x-nrg.desktop
mkdir -p $RPM_BUILD_ROOT/usr/share/locale/zh_CN/LC_MESSAGES
cp -f $RPM_BUILD_ROOT/usr/share/locale/zh_CN.GB2312/LC_MESSAGES/kiso.mo $RPM_BUILD_ROOT/usr/share/locale/zh_CN/LC_MESSAGES/
mkdir -p $RPM_BUILD_ROOT/usr/share/kiso
cp -f %{SOURCE1} $RPM_BUILD_ROOT/usr/share/kiso/Test.iso
magic_rpm_clean.sh
%clean
rm -rf %{buildroot}

%post -p /sbin/ldconfig
%postun -p /sbin/ldconfig
%files
%defattr(-, root, root)
%doc AUTHORS COPYING ChangeLog NEWS README TODO
/usr
%exclude /usr/*/debug*

%changelog
* Wed Oct 04 2006 Liu Di <liudidi@gmail.com> - 0.8.3-2mgc
- rebuild

* Fri Dec 30 2005 KanKer <kanker@163.com>
- update 0.8.3
* Fri Aug 12 2005 KanKer <kanker@163.com>
- update 0.8.2.1
* Thu Jul 28 2005 KanKer <kanker@163.com>
- update 0.8.2c
* Sun Jul 3 2005 KanKer <kanker@163.com>
- update 0.8.2
* Mon May 16 2005 KanKer <kanker@163.com>
- update to 0.8.1.
* Mon Nov 8 2004 KanKer <kanker@163.com>
- update kiso to 0.7b.
* Sun Oct 24 2004 KanKer <kanker@163.com>
- update
* Tue Sep 14 2004 KanKer <kanker@163.com>
- link mo for zh_CN
* Tue Jun 22 2004 KanKer <kanker@163.com>
- add zh_CN.po translated by KDE
* Sun May 23 2004 KanKer <kanker@163.com>
- add zh_CN.po.
