diff -ru hwloc-1.7-orig/src/topology-gl.c hwloc-1.7/src/topology-gl.c
--- hwloc-1.7-orig/src/topology-gl.c	2013-03-26 21:00:17.000000000 +0100
+++ hwloc-1.7/src/topology-gl.c	2013-04-23 16:18:46.497469010 +0200
@@ -85,12 +85,18 @@
       gpu_number = ptr_binary_data[1];
       free(ptr_binary_data);
 
+#ifdef NV_CTRL_PCI_DOMAIN
+
       /* Gets the ID's of the GPU defined by gpu_number
        * For further details, see the <NVCtrl/NVCtrlLib.h> */
       err = XNVCTRLQueryTargetAttribute(display, NV_CTRL_TARGET_TYPE_GPU, gpu_number, 0,
                                         NV_CTRL_PCI_DOMAIN, &nv_ctrl_pci_domain);
       if (!err)
         continue;
+#else
+      nv_ctrl_pci_domain = 0;
+#endif
+
 
       err = XNVCTRLQueryTargetAttribute(display, NV_CTRL_TARGET_TYPE_GPU, gpu_number, 0,
                                         NV_CTRL_PCI_BUS, &nv_ctrl_pci_bus);
@@ -102,11 +108,6 @@
       if (!err)
         continue;
 
-      err = XNVCTRLQueryTargetAttribute(display, NV_CTRL_TARGET_TYPE_GPU, gpu_number, 0,
-                                        NV_CTRL_PCI_DOMAIN, &nv_ctrl_pci_domain);
-      if (!err)
-        continue;
-
       err = XNVCTRLQueryTargetAttribute(display, NV_CTRL_TARGET_TYPE_GPU, gpu_number, 0,
                                         NV_CTRL_PCI_FUNCTION, &nv_ctrl_pci_func);
       if (!err)
Only in hwloc-1.7/src: .topology-gl.c.swp
