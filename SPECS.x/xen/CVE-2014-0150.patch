--- xen-4.4.1/tools/qemu-xen-traditional/hw/virtio-net.c.orig	2014-07-02 15:54:37.000000000 +0100
+++ xen-4.4.1/tools/qemu-xen-traditional/hw/virtio-net.c	2014-11-18 20:50:13.593122915 +0000
@@ -192,7 +192,7 @@
         return VIRTIO_NET_ERR;
 
     if (mac_data.entries) {
-        if (n->mac_table.in_use + mac_data.entries <= MAC_TABLE_ENTRIES) {
+        if (n->mac_table.in_use <= MAC_TABLE_ENTRIES - mac_data.entries) {
             memcpy(n->mac_table.macs + (n->mac_table.in_use * ETH_ALEN),
                    elem->out_sg[2].iov_base + sizeof(mac_data),
                    mac_data.entries * ETH_ALEN);
